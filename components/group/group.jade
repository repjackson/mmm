template(name='my_groups')
    .ui.stackable.padded.grid
        .row
            .twelve.wide.column
                .ui.inline.header 
                    i.company.icon
                    |your groups
                if is_leader
                    .ui.icon.button.add_group(title='add group')
                        //- +i name='plus' classes='ui mini inline image'
                        i.green.large.plus.icon
                        //- |add group
        .row
            .sixteen.wide.column
                .ui.stackable.four.cards
                    each groups
                        +group_card

template(name='groups')
    .ui.stackable.padded.grid
        .row
            .twelve.wide.column
                .ui.inline.header 
                    +i name='group'
                    |groups
                if currentUser
                    .ui.icon.button.add_group(title='add group')
                        //- +i name='plus' classes='ui mini inline image'
                        i.green.large.plus.icon
                        //- |add group
        .row
            .sixteen.wide.column
                .ui.stackable.four.cards
                    each groups
                        +group_card

template(name='group_card')
    .ui.card
        a(href="/group/#{_id}")
            img.ui.fluid.image(src="{{c.url group_image_id crop='lpad'}}")
            //- img.ui.fluid.image(src="{{c.url group_image_id crop='lpad'}}")
        .content
            a.ui.header(href="/group/#{_id}" title='balance') #{title}
            .ui.green.inline.header $#{gsd.group_balance}
            .ui.green.inline.small.header(title='income') ($#{gsd.total_credit_amount}
            .ui.red.inline.small.header(title='expenses') / -$#{gsd.total_debit_amount})
            a.ui.header(href="/group/#{_id}")
                |view 
                i.right.chevron.icon

                    
template(name='group_view_layout')
    +leader_nav
    with current_doc
        .ui.stackable.padded.grid
            .row
                .four.wide.column
                    //- a.ui.fluid.button(href="/my_groups")
                    //-     i.chevron.left.grey.icon
                    //-     i.company.icon
                    //-     //- +i name='group' classes='ui inline mini image'
                    //-     |groups
                    .ui.center.aligned.huge.header
                        | #{company_name}
                    +image_view key='group_image_id' label='image' direct=true
                    .ui.big.fluid.vertical.pointing.menu
                        a.item(href="/group/#{_id}/members" class="{{isActiveRoute regex='group_members'}}")
                            i.dashboard.grey.icon
                            if is_admin
                                img(src="https://img.icons8.com/color/48/000000/the-flash-sign--v2.png")        
                            | dashboard
                        a.item(href="/group/#{_id}/lunch" class="{{isActiveRoute regex='group_lunch'}}")
                            i.food.grey.icon
                            if is_admin
                                img(src="https://img.icons8.com/color/48/000000/the-flash-sign--v2.png")        
                            | lunch
                        a.item(href="/group/#{_id}/reports" class="{{isActiveRoute regex='group_reports'}}")
                            i.line.chart.grey.icon
                            if is_admin
                                img(src="https://img.icons8.com/color/48/000000/batman-old.png")        
                            | reports
                        a.item(href="/group/#{_id}/feed" class="{{isActiveRoute regex='group_feed'}}")
                            i.list.grey.icon
                            if is_admin
                                img(src="https://img.icons8.com/color/48/000000/batman-old.png")        
                            | feed
                    .ui.header
                        if is_admin
                            img(src="https://img.icons8.com/color/48/000000/the-flash-sign--v2.png")        
                        small leader
                        | #{leader_name}
                    a.ui.fluid.large.button(href="/group/#{_id}/edit/info")
                        i.pencil.icon
                        | edit
                .twelve.wide.column
                    +yield
    //- +leader_footer



template(name='group_loans')
    .ui.header 
        i.money.icon
        |group loans
    +loans


template(name='group_lunch')        
    .ui.padded.stackable.grid
        .row
            .four.wide.column
                .ui.center.aligned.large.button.back_to_group
                    i.chevron.left.icon
                    |#{current_doc.title}
                    //- |group
            .eight.wide.column
                .ui.center.aligned.large.header 
                    //- +i name='food'
                    i.food.icon
                    |lunch
            .four.wide.column
            .ui.four.stackable.cards
                each group_members
                    unless lunch_chosen
                        .ui.card
                            img.ui.image(src="{{c.url profile_image_id width=300 height=300 gravity='face' crop='fill'}}")
                            .content
                                .ui.header #{name}
                                .ui.huge.labeled.icon.fluid.basic.button.choose_home
                                    i.home.icon
                                    |home 
                                    span.ui.red.text -3c
                                .spacer
                                .ui.huge.labeled.icon.fluid.basic.button.choose_cafeteria
                                    i.food.icon
                                    |cafeteria
                                    span.ui.red.text -5c





template(name='group_credits')
    .ui.header 
        i.money.icon
        |group loans
    +loans

    

template(name='group_members')
    .ui.header 
        i.dashboard.grey.icon
        |group dashboard
    with current_doc
        .ui.styled.fluid.accordion 
            .active.title 
                .ui.header
                    | group actions
                    i.dropdown.icon
            .active.content
                .ui.two.column.grid
                    .column
                        .ui.small.header 
                            i.calendar.grey.inline.icon
                            i.retweet.grey.inline.icon
                            |weekly automatic actions
                        each weekly_automatic_credits
                            .ui.disabled.button(class=bulk_action_class) #{title}
                                span.ui.green.text +#{amount}
                        each weekly_automatic_debits
                            .ui.disabled.button(class=bulk_action_class) #{title}
                                span.ui.green.text +#{amount}
                    .column
                        .ui.small.header 
                            i.clock.grey.inline.icon
                            i.retweet.grey.inline.icon
                            |daily automatic actions
                        each daily_automatic_credits
                            .ui.disabled.button.trigger(class=bulk_action_class) #{title}
                                span.ui.green.text +#{amount}
                        each daily_automatic_debits
                            .ui.disabled.button.trigger(class=bulk_action_class) #{title}
                                span.ui.green.text +#{amount}
                .ui.two.column.grid
                    .column
                        .ui.small.header 
                            i.calendar.grey.inline.icon
                            i.hand.point.up.outline.grey.inline.icon
                            |weekly manual group actions
                        //- .ui.button.pay_salary disperse weekly paycheck
                        //-     span.ui.green.text +#{salary_amount}
                        each weekly_manual_credits
                            .ui.button.trigger(class=bulk_action_class) #{title}
                                span.ui.green.text +#{amount}
                        each weekly_manual_debits
                            .ui.button.trigger(class=bulk_action_class) #{title}
                                span.ui.red.text -#{amount}
                    .column
                        .ui.small.header
                            i.clock.grey.inline.icon
                            i.hand.point.up.outline.grey.inline.icon
                            | daily manual group actions
                        each daily_manual_group_credits
                            .ui.button.credit_group(class=bulk_action_class) #{title}
                                span.ui.green.text +#{amount}
                        each daily_manual_group_debits
                            .ui.button.debit_group(class=bulk_action_class) #{title}
                                span.ui.red.text -#{amount}
                        //- 
                        //- each daily_actions
                        //-     .ui.button #{title}
                        //- .ui.button.charge_rent charge daily rent 
                        //-     span.ui.red.text -#{desk_rental_amount}
                        //- .ui.button.charge_janitor_base charge daily janitor fee 
                        //-     span.ui.red.text -#{janitor_base_amount}
                        //- .ui.button.charge_janitor_extra charge daily janitor extra fee 
                        //-     span.ui.red.text -#{janitor_extra_amount}
    .ui.accordion
        each group_members
            .active.title
                img.ui.avatar.image(src="{{c.url profile_image_id width=300 height=300 gravity='face' crop='fill'}}")
                .ui.inline.header
                    i.dropdown.icon
                    |#{first_name} #{last_name} 
                .ui.small.inline.header #{credit}c
                i.green.plus.circle.big.link.icon.add_bonus
                i.red.minus.circle.big.link.icon.add_fine
                //- .ui.icon.circular.button.
            //- .ui.item
            //- .image
            .active.content
                a.ui.basic.green.large.right.floated.button(href="/user/#{username}")
                    |view profile
                    i.right.chevron.icon
                .description
                    .ui.two.column.stackable.grid
                        .column
                            //- .ui.button bonus
                            //- .ui.button overtime
                            each individual_credit_types
                                +individual_credit_button
                        .column
                            each individual_debit_types
                                +individual_debit_button
                //- .extra.content.smallscroll
                //-     .ui.list
                //-         each member_events
                //-             .item #{text} #{when}
                //-                 +remove_button
                                
            //- .ui.item
            //-     .image
            //-         img.ui.mini.image(src="{{c.url profile_image_id width=300 height=300 gravity='face' crop='fill'}}")
            //-     .content
            //-         a.header(href="/user/#{username}")
            //-             |#{first_name} #{last_name} 
            //-         .ui.small.header #{credit}c
            //-         .description
            //-             each individual_credit_types
            //-                 +class_credit_button
            //-             each group_debit_types
            //-                 +class_debit_button
            //-     .extra.content.smallscroll
            //-         .ui.list
            //-             each member_events
            //-                 .item #{text} #{when}
            //-                     +remove_button
            //- 
                                        
template(name='individual_credit_button')
    .ui.button.credit_member 
        |#{title}
        span.ui.green.text
            |+#{amount}
    
template(name='individual_debit_button')
    .ui.button.debit_member 
        |#{title}
        span.ui.red.text
            |-#{amount}


    
template(name='group_reports')
    with current_doc
        +group_stats
        .ui.stackable.padded.grid
            .row
                //- .four.wide.column
                //-     a.ui.big.button(href="/group/#{_id}/view" title='save')
                //-         i.chevron.left.icon
                //-         |group
                //- .twelve.wide.column
                //- .ui.large.header 
                //-     i.line.chart.icon
                //-     |member reports
                table.ui.celled.very.basic.table
                    thead
                        tr
                            th member
                            //- th week 1
                            //- th week 2
                            //- th week 3
                            //- th week 4
                            th credit
                    tbody
                        each group_members
                            tr
                                td 
                                    a.ui.header(href="/user/#{username}") 
                                        img.ui.rounded.avatar.image(src="{{c.url profile_image_id width=300 height=300 gravity='face' crop='fill'}}")
                                        |#{first_name} #{last_name}
                                //- td 
                                //-     .ui.green.header +1
                                //-     .ui.red.header -3
                                //- td 
                                //-     .ui.green.header +1
                                //-     .ui.red.header -3
                                //- td 
                                //-     .ui.green.header +1
                                //-     .ui.red.header -3
                                //- td 
                                //-     .ui.green.header +1
                                //-     .ui.red.header -3
                                td.credit_view
                                    .ui.header.credit_view 
                                        .ui.header.credit_view $#{credit}




template(name='group_feed')
    .ui.inline.header 
        +i name='rss'
        |feed
    if is_admin 
        .ui.button.remove_all_events
            i.shield.icon
            |remove all events
    div
    .ui.feed.scrolling
        each group_events
            .event 
                .label
                    img.ui.avatar.image(src="{{c.url target_user.profile_image_id height=100 gravity='face' crop='fill'}}")
                    if is_credit
                        +i name='deposit' classes='ui inline mini image'
                    if is_debit
                        +i name='withdrawal' classes='ui inline mini image'
                    else if icon
                        +i name=icon
                .content
                    .summary
                        a.user(href="/user/#{target_user.username}")
                            |#{target_user.name}
                        |#{text}
                        .date #{when}
                    .meta
                        +voting_small
                        //- a.like
                        //-     i.like.icon 
                        //-     |4 likes
                        a.remove
                            i.undo.icon
                        //- if is_dev
                        //-     +remove_button



template(name='group_stats')
    .ui.two.column.grid
        .column
            .ui.header.refresh_group_stats
                //- +ismall name='line-chart'
                i.line.chart.icon
                |stats
            div
            .ui.green.inline.header $#{gsd.group_balance}
            | balance
            div
            .ui.green.inline.header $#{gsd.total_credit_amount}
            | income
            div
            .ui.red.inline.header -$#{gsd.total_debit_amount}
            | expenses
        .column
            .ui.big.list
                .item #{views} views
                .item #{gsd.member_count} members
                .item #{gsd.credit_count} total credits
                .item #{gsd.debit_count} total debits
                .item $#{gsd.average_credit_per_member} credit/member
                .item $#{gsd.average_debit_per_member} debit/member
        

template(name='group_edit_layout')
    +leader_nav
    with current_doc
        .ui.stackable.padded.grid
            .row
                .four.wide.column 
                    .ui.header 
                        small editing 
                        div
                        strong #{company_name}
                        div
                        small group
                    a.ui.huge.icon.fluid.button(href="/group/#{_id}/members" title='save')
                        i.checkmark.green.icon
                        //- |Save
                    //- if is_admin
                    .ui.vertical.large.fluid.pointing.menu
                        a.item(href="/group/#{_id}/edit/info" class="{{isActiveRoute regex='group_edit_info'}}") 
                            |info
                            i.info.icon
                        a.item(href="/group/#{_id}/edit/members" class="{{isActiveRoute regex='group_edit_members'}}") 
                            |members
                            i.users.icon
                        a.item(href="/group/#{_id}/edit/credits" class="{{isActiveRoute regex='group_edit_credits'}}")
                            |credits
                            i.plus.icon
                        a.item(href="/group/#{_id}/edit/debits" class="{{isActiveRoute regex='group_edit_debits'}}")
                            |debits
                            i.minus.icon
                        a.item(href="/group/#{_id}/edit/templates" class="{{isActiveRoute regex='group_edit_templates'}}")
                            |templates
                            i.clone.icon
                        a.item(href="/group/#{_id}/edit/files" class="{{isActiveRoute regex='group_edit_files'}}")
                            |files
                            i.file.icon
                        a.item(href="/group/#{_id}/edit/features" class="{{isActiveRoute regex='group_edit_features'}}")
                            |features
                            i.th.icon
                .twelve.wide.column
                    +yield
                                    
template(name='group_edit_info')
    .ui.header 
        i.info.icon
        |info
    .ui.two.column.grid
        .column
            +text_edit key='title' label='group title' direct=true
            +text_edit key='leader_name' label='leader name' placeholder='enter your name' tooltip='examples: john smith' direct=true
            +text_edit key='company_name' label='company name' direct=true
            +image_edit key='group_image_id' label='image' direct=true
        .column
            +textarea_edit key='description' label='description' direct=true
            +array_edit key='tags' label='tags' icon='tags' direct=true
            if is_admin
                +leader_selector
    if is_admin
        +remove_button
                                    
template(name='group_edit_members')                                    
    //- .ui.large.header 
    //-     i.users.icon
    //-     |members
    +member_selector

template(name='group_edit_credits')
    .ui.large.header 
        i.plus.icon
        |credits
    .ui.stackable.grid
        .eight.wide.column
            .ui.small.header from template
            .ui.fluid.huge.vertical.pointing.menu
                each template_credit_types
                    +credit_menu_item
            div
            .ui.small.inline.header custom
            .ui.icon.button.add_credit_type
                i.plus.icon
            .ui.fluid.huge.vertical.pointing.menu
                each custom_credit_types
                    +credit_menu_item
        .eight.wide.column
            div
            with selected_credit
                +transaction
                        
                        
template(name='credit_menu_item')                        
    a.item.select_credit(class=credit_class) 
        |#{title}
        small +$#{amount}
        if is_automatic
            i.lightning.yellow.icon
        if is_individual
            i.user.outline.icon(title='member scope')
        if is_group 
            i.users.icon(title='group scope')
        if is_admin
            i.circular.remove.icon.remove_credit

                        
template(name='group_edit_debits')       
    .ui.large.header 
        i.chevron.up.icon
        |debits
    .ui.stackable.grid
        .row
            .eight.wide.column
                .ui.small.header from template
                .ui.fluid.huge.vertical.pointing.menu
                    each template_debit_types
                        +debit_menu_item
                div
                .ui.small.inline.header custom
                .ui.icon.button.add_debit_type
                    i.plus.icon
                .ui.fluid.huge.vertical.pointing.menu
                    each custom_debit_types
                        +debit_menu_item
            .eight.wide.column
                with selected_debit
                    +transaction





template(name='debit_menu_item')
    a.item.select_debit(class=debit_class) 
        |#{title}
        small $#{amount}
        if is_automatic
            i.lightning.yellow.icon
        else 
            i.hand.icon
        if is_individual
            i.user.outline.icon(title='member scope')
        if is_group 
            i.users.icon(title='group scope')



template(name='transaction')
    .ui.segment
        if editing_transaction
            //- +image_edit key='image_id' label='image' direct=true
            +text_edit key='title' direct=true
            +number_edit key='amount' direct=true
            div
            .ui.small.grey.inline.header dispersion type
            //- +boolean_edit key='automatic' direct=true
            +key_value_edit key='dispersion_type' value='automatic' label='automatic'
            +key_value_edit key='dispersion_type' value='manual' label='manual'
            div
            if is_automatic
                .ui.small.grey.inline.header automatic period
                +key_value_edit key='automatic_period' value='daily' label='daily'
                +key_value_edit key='automatic_period' value='weekly' label='weekly'
                div
            div
            if is_manual
                div
                .ui.small.grey.inline.header manual period
                +key_value_edit key='manual_period' value='daily' label='daily'
                +key_value_edit key='manual_period' value='weekly' label='weekly'
                if is_manual_daily
                    div
                    .ui.small.grey.inline.header manual limit type
                    +key_value_edit key='manual_limit_type' value='single' label='single'
                    +key_value_edit key='manual_limit_type' value='multi' label='multi'
                //- div
                //- if limit
                //-     +number_edit key='limit_amount' label='limit amount'
            div
            .ui.small.grey.inline.header scope
            +key_value_edit key='scope' value='individual' label='member'
            +key_value_edit key='scope' value='group' label='group'
            div
            +remove_button
            .ui.divider
        
            .ui.fluid.button.save_transaction
                i.green.checkmark.icon
                |save
        else 
            .ui.header 
                small title
                | #{title}
            .ui.header 
                small amount
                | $#{amount}
            div
            .ui.small.grey.inline.header dispersion type
            .ui.inline.header #{dispersion_type}
            div
            if is_automatic
                .ui.small.grey.inline.header automatic period
                .ui.inline.header #{automatic_period}
                div
            if is_manual
                div
                .ui.small.grey.inline.header manual period
                .ui.inline.header #{manual_period}
                if is_manual_daily
                    div
                    .ui.small.grey.inline.header manual limit type
                    .ui.inline.header #{manual_limit_type}
            div
            .ui.small.grey.inline.header scope
            .ui.inline.header #{scope}
            .ui.divider
            .ui.fluid.button.edit_transaction
                i.pencil.icon
                |edit




template(name='group_edit_templates')       
    .ui.large.header 
        i.clone.icon
        |templates
    .ui.stackable.grid
        .row
            .eight.wide.column
                .ui.header my templates
                .ui.button.generate_from_current generate template from current structure
                .ui.fluid.huge.vertical.pointing.menu
                    each my_transaction_templates
                        a.item.select_template(class=template_class) 
                            |#{title}
                .ui.header template marketplace
                .ui.fluid.huge.vertical.pointing.menu
                    each transaction_templates
                        a.item.select_template(class=template_class) 
                            |#{title}
            .eight.wide.column
                with selected_template
                    +template


template(name='template')
    .ui.segment
        if editing_template
            .ui.header editing template
            //- +image_edit key='image_id' label='image' direct=true
            +text_edit key='title' direct=true
            div
            +remove_button
            .ui.divider
            .ui.fluid.button.save_template
                i.green.checkmark.icon
                |save
        else 
            .ui.header viewing template
            .ui.header 
                small title
                | #{title}
            .ui.header 
                small author
                | #{_author_username}
            div
            .ui.small.grey.inline.header credits
            .ui.bulleted.list
                each group_credits 
                    .item #{title} +#{amount}
            .ui.small.grey.inline.header debits
            .ui.bulleted.list
                each group_debits 
                    .item #{title} -#{amount}
            div
            .ui.divider
            if is_author
                .ui.fluid.button.edit_template
                    i.pencil.icon
                    |edit
            .ui.fluid.button.clone_template
                i.clone.icon
                |clone
            




template(name='group_edit_features')       
    .ui.large.inline.header 
        i.th.icon
        |features
    if is_dev
        .ui.icon.button.add_feature
            i.plus.icon
    .ui.stackable.grid
        .row
            .eight.wide.column
                .ui.header
                    small current monthly bill 
                    |$#{group_monthly_bill}/month
        .row
            .eight.wide.column
                .ui.small.header enabled
                .ui.fluid.huge.vertical.pointing.menu
                    each enabled_features
                        a.item.select_feature(class=feature_class) 
                            if icon
                                i.icon(class=icon)
                            |#{title}
                            small $#{monthly_price}
                div
                .ui.small.inline.header available
                .ui.fluid.large.vertical.pointing.menu
                    each disabled_features
                        a.item.select_feature(class=feature_class) 
                            if icon
                                i.icon(class=icon)
                            |#{title}
                            small $#{monthly_price}/month
            .eight.wide.column
                with selected_feature
                    +feature





template(name='feature')
    .ui.segment
        if editing_feature
            .ui.header editing feature
            +text_edit key='title' direct=true
            +image_edit key='image_id' label='image' direct=true
            +text_edit key='icon' direct=true
            +array_edit key='tags' label='tags' direct=true
            div
            +number_edit key='monthly_price' label='monthly price' direct=true
            div
            +remove_button
            .ui.divider
            .ui.fluid.button.save_feature
                i.green.checkmark.icon
                |save
        else 
            .ui.header viewing feature
            .ui.header 
                small title
                | #{title}
            div
            |#{description}
            div
            .ui.divider
            if is_dev
                .ui.fluid.button.edit_feature
                    i.pencil.icon
                    |edit
            unless enabled
                .ui.fluid.button.enable_feature
                    i.toggle.off.icon
                    |enable
            else 
                .ui.fluid.button.disable_feature
                    i.toggle.on.icon
                    |disable
            

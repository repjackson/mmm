template(name='user_edit')
    with user_from_username_param          
        .ui.stackable.padded.grid
            .three.column.row
                .column
                    .ui.center.aligned.large.inline.grey.header
                        | #{user_from_username_param.first_name} #{user_from_username_param.last_name}
                    //- +i name='pencil'
                    .ui.small.inline.header @#{user_from_username_param.username}
                    a.ui.big.button(href="/user/#{user_from_username_param.username}/") 
                        i.checkmark.big.green.icon
                        strong save
                    .ui.hidden.divider
                    +image_edit key='profile_image_id' icon='picture' title='profile image' direct=true
                    if is_current_user
                        +password_edit
                        //- +phone_editor
                        +username_edit
                    if is_admin
                        with user_from_username_param
                            .ui.orange.basic.button.remove_user 
                                i.remove.icon
                                |delete user
                .column
                    .ui.form
                        +text_edit key='first_name' label='first name' icon='header' direct=true
                        +text_edit key='last_name' label='last name' icon='header' direct=true
                        div
                        .ui.basic.segment
                            .ui.header 
                                i.envelope.outline.icon
                                |emails
                            +emails_edit
                        +number_edit key='credit' label='credit' icon='money' direct=true
                        div
                        +phone_edit key='phone' label='phone' icon='phone' direct=true
                        +array_edit key='tags' label='tags' direct=true
                    

template(name='username_edit')
    .ui.small.header 
        i.i.cursor.icon
        |change username [#{user_from_username_param.username}]
    .ui.icon.fluid.input
        input.new_username(type='text' placeholder='new username...')
        i.play.link.icon.change_username


     
template(name='phone_editor')
    .ui.small.header    
        i.phone.icon
        |phone
    .ui.icon.fluid.input(title='Add Phone')
        i.plus.icon
        input#phone.form-control(type='phone', name='phone', value='{{newNumber}}')
    if user_from_username_param.profile.phone
        if user_from_username_param.profile.phone_verified
            .ui.label verified
        else
            p
                .ui.label not verified
                a.resend_verification(href='#')
                    |resend code
                .ui.small.icon.basic.button.remove_phone(title='remove phone')
                    i.remove.icon
    else
        .ui.fluid.basic.button.update_phone add phone



template(name='password_edit')
    .ui.small.grey.header
        +i name='password'
        |change password
    //- .ui.fluid.input
    //-     input#password(type='password', placeholder='old password')
    .ui.fluid.icon.input
        input#new_password(type='password', placeholder='new password')
    if is_dev
        .ui.fluid.basic.button.send_enrollment_email
            |send enrollment email
    if is_admin
        .ui.fluid.basic.button.reset_password
            |reset password
    .ui.fluid.large.basic.button.set_password
        +i name='password' classes='ui mini inline image'
        | set password
            
            
            
template(name='emails_edit')
    //- .ui.small.grey.header 
    //-     i.envelope.icon
    //-     | email(s)
    //- #test_email.ui.big.basic.button test email
    .ui.divided.list
        each current_user.emails
            .item 
                // unless verified
                //     .right.floated.content
                //         .ui.basic.button Verify
                .content
                    if verified
                        .ui.big.basic.label(title='verified')
                            | #{address}
                            i.checkmark.icon
                    else
                        .ui.big.basic.label
                            //- i.ban.icon
                            | #{address}
                        .send_verification_email.ui.basic.button 
                            |verify
                            i.caret.right.icon
                    .ui.small.icon.basic.button.remove_email
                        i.remove.icon
    .ui.action.big.fluid.icon.action.input
        input#new_email(type='email' placeholder='add new email address' autocomplete="off")
        #add_email.ui.submit.icon.button 
            i.plus.icon
            |email

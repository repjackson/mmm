template(name='nav')
    .ui.attached.borderless.inverted.blue.topnav.menu
        if is_loading
            .item
                i.big.loading.money.icon
        if currentUser
            a.compact.item(href='/grid' class="{{isActivePath '/grid'}}") 
                img.ui.tiny.compact.image(src="{{c.url 'mmm_logo_small' height=150 }}" title='Home')
            a.item(href='/classrooms' title='classrooms')
                +ismall name='class'
                span.mobile.hidden &nbsp; classrooms
            //- a.item(href='/teachers' title='teachers')
            //-     +ismall name='teacher'
            //-     //- |teachers
            a.item(href='/m/student' title='students') 
                +ismall name='students'
                span.mobile.hidden &nbsp; students
            //- a.item(href='/m/shop' title='shop') 
            //-     +ismall name='shop'
            //-     span.mobile.hidden &nbsp; shop
            //- a.item(href='/m/job' title='jobs') 
            //-     +ismall name='find-matching-job'
            //-     span.mobile.hidden &nbsp; jobs
            //- a.item(href='/m/loan' title='loans') 
            //-     +ismall name='debt'
            //-     span.mobile.hidden &nbsp; loans
        
        else
            a.compact.item(href='/' class="{{isActivePath '/'}}") 
                img.ui.tiny.compact.image(src="{{c.url 'mmm_logo_small' height=200 }}" title='Home')
            //- |Home
        //- a.item(href='/schools' title='schools') 
        //-     +ismall name='school'
            //- schools
        //- a.item(href='/classroom/i4mdNbN8ykJcr6w9q/dashboard' title='classrooms')
        //-     +ismall name='dashboard'
        unless currentUser
            a.ui.item(href='/about')
                |about
            a.ui.item(href='/schools')
                |schools
            a.ui.item(href='/donors')
                |donors
            a.ui.item(href='/teachers')
                |teachers
            a.ui.item(href='/parents')
                |parents
        .right.menu
            unless currentUser
                .item
                    a.ui.button(href='/login' title='login') log in
                .item
                    a.ui.teal.button sign up
            if currentUser
                if is_admin
                    a.item(href='/admin' title='admin')
                        //- +i name='user-shield'
                        i.shield.icon
                        |admin
                if is_dev
                    a.icon.item(href="/m/model")
                        i.database.icon
                unless logging_out
                    //- a.item(href="/notifications")
                    //-     i.bell.grey.large.outline.icon
                    //- a.item(href="/mail")
                    //-     //- +i name='envelope'
                    //-     i.envelope.grey.large.outline.icon
                    a.item(href="/user/#{currentUser.username}" class=member_nav_button_class title=member_nav_button_title)
                        if currentUser.profile_image_id
                            img.ui.avatar.inline.image(src="{{c.url currentUser.profile_image_id width=100 height=100 gravity='face' crop='fill'}}")
                        else
                            +ismall name='user-male'
                        span.mobile.hidden #{currentUser.name} #{currentUser.credit}
                    a#logout.item(href='#' title='log out')
                        i.sign.out.icon
                if logging_out
                    .item
                        i.loading.circle.notch.icon


template(name='footer')
    .ui.stackable.secondary.padded.grid.segment
        .three.wide.column
            img.ui.tiny.inline.image(src="{{c.url 'bcorp' }}")
            img.ui.small.image(src="{{c.url 'stripe_badge' }}")
            .ui.header 
                i.copyright.outline.icon
                | mini money 2019
        .three.wide.column
            .ui.link.big.list
                a.item(href='/blog') blog
                a.item(href='/about') about
                a.item(href="/terms_of_service") terms of service
                a.item(href='/privacy') privacy policy
                a.item(href='/stats') stats
                a.item(href='/investors') investors
                a.item(href='/contact') contact
        .three.wide.column
            .ui.link.big.list
                a.item(href='/blog') classrooms
                a.item(href='/about') teachers
                a.item(href="/terms_of_service") parents
                a.item(href='/privacy') students
                a.item(href='/investors') schools
                a.item(href='/contact') administrators
                a.item(href='/contact') donors
            +add_button label='bug' model='bug' icon='bug'
            if is_dev    
                with current_user
                    +role_switcher
        .seven.wide.column
            //- unless currentUser
            //-     a.ui.big.button(href='/login')
            //-         i.sign.in.icon
            //-         |login
            
            +footer_chat
            if is_eric
                with currentUser
                    +role_switcher

            
                
template(name='footer_chat')
    .ui.grey.inline.header 
        +i name='chat'
        |chat
    .ui.list.scroll
        each chat_messages
            .item(title="by #{author.name} #{when}")
                if author
                    img.ui.avatar.image(src="{{c.url author.kiosk_photo width=200 height=200 gravity='face' crop='fill'}}")
                |#{text}
                //- small #{when}
                if is_author
                    span
                        i.remove.link.icon.remove_message
    .ui.bottom.attached.fluid.icon.large.input
        i.plus.blue.icon
        input.new_footer_chat_message(type='text' placeholder='add message')





template(name='my_latest_activity')
    .ui.grey.header 
        //- i.grey.rss.icon
        +ismall name='rss'
        |your activity
    .ui.list
        each my_latest_activity
            .item 
                img.ui.avatar.image(src="{{c.url author.kiosk_photo width=200 height=200 gravity='face' crop='fill'}}")
                |#{text} #{body}
                small #{when}


template(name='latest_activity')
    .ui.grey.header 
        //- i.grey.rss.icon
        +ismall name='rss'
        |all activity
    .ui.list
        each latest_activity
            .item 
                img.ui.avatar.image(src="{{c.url author.kiosk_photo width=200 height=200 gravity='face' crop='fill'}}")
                |#{text} #{body} 
                .ui.basic.label #{log_type}
                small #{when}


template(name='role_switcher')
    .ui.inline.center.aligned.small.header 
        |#{username} role switcher
    if is_eric
        +multi_doc_edit key='roles' label='roles' ref_model='role' direct=true
        div
        //- +user_array_element_toggle key='roles' value='dev' user=currentUser
    //- if current_user
    //-     with current_user
    //- else if currentUser
    //-     with currentUser
    //- +multi_doc_edit key='roles' label='roles' ref_model='role' direct=true
    //- if is_admin
    //-     //- +multi_doc_edit key='current_roles' label='current roles' ref_model='role' direct=true
    //-     +user_array_element_toggle key='current_roles' value='admin' user=currentUser
    //-     +user_array_element_toggle key='current_roles' value='member' user=currentUser
    //-     +user_array_element_toggle key='current_roles' value='staff' user=currentUser
    //-     //- +user_array_element_toggle key='roles' value='student' user=currentUser
    //-     //- +user_array_element_toggle key='roles' value='owner' user=currentUser
